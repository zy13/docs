<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1、state和setState | zy&#39;s docs</title>
    <meta name="description" content="Welcome!">
    <limk rel="icon" href="/docs/logo.png"></limk>
  <link rel="manifest" href="/docs/manifest.json">
  <meta name="theme-color" content="#ccc">
    
    <link rel="preload" href="/docs/assets/css/0.styles.8912bdf8.css" as="style"><link rel="preload" href="/docs/assets/js/app.acf4c017.js" as="script"><link rel="preload" href="/docs/assets/js/47.8555fc5c.js" as="script"><link rel="preload" href="/docs/assets/js/221.2383e08f.js" as="script"><link rel="prefetch" href="/docs/assets/js/68.0949f5a6.js"><link rel="prefetch" href="/docs/assets/js/1.6a2045ef.js"><link rel="prefetch" href="/docs/assets/js/2.b5f3db6a.js"><link rel="prefetch" href="/docs/assets/js/3.219f09ba.js"><link rel="prefetch" href="/docs/assets/js/4.8ee55220.js"><link rel="prefetch" href="/docs/assets/js/5.87cde8e5.js"><link rel="prefetch" href="/docs/assets/js/6.0e65e52f.js"><link rel="prefetch" href="/docs/assets/js/7.61916ad4.js"><link rel="prefetch" href="/docs/assets/js/8.c2320f88.js"><link rel="prefetch" href="/docs/assets/js/9.3939e875.js"><link rel="prefetch" href="/docs/assets/js/10.ab015975.js"><link rel="prefetch" href="/docs/assets/js/11.f26d0dbe.js"><link rel="prefetch" href="/docs/assets/js/12.a83b5e17.js"><link rel="prefetch" href="/docs/assets/js/13.3f4ce23b.js"><link rel="prefetch" href="/docs/assets/js/14.788d1837.js"><link rel="prefetch" href="/docs/assets/js/15.4578a994.js"><link rel="prefetch" href="/docs/assets/js/16.c88f046d.js"><link rel="prefetch" href="/docs/assets/js/17.bda3b65a.js"><link rel="prefetch" href="/docs/assets/js/18.f51293d6.js"><link rel="prefetch" href="/docs/assets/js/19.e23bdb82.js"><link rel="prefetch" href="/docs/assets/js/20.9a922dab.js"><link rel="prefetch" href="/docs/assets/js/21.2c6da050.js"><link rel="prefetch" href="/docs/assets/js/22.6118c2ea.js"><link rel="prefetch" href="/docs/assets/js/23.ce4cf644.js"><link rel="prefetch" href="/docs/assets/js/24.ae10fafa.js"><link rel="prefetch" href="/docs/assets/js/25.928437eb.js"><link rel="prefetch" href="/docs/assets/js/26.8cb0b9b6.js"><link rel="prefetch" href="/docs/assets/js/27.382eb8da.js"><link rel="prefetch" href="/docs/assets/js/28.17c15003.js"><link rel="prefetch" href="/docs/assets/js/29.d47780b1.js"><link rel="prefetch" href="/docs/assets/js/30.ca5d8646.js"><link rel="prefetch" href="/docs/assets/js/31.e97fc58f.js"><link rel="prefetch" href="/docs/assets/js/32.0c64de17.js"><link rel="prefetch" href="/docs/assets/js/33.930d6f78.js"><link rel="prefetch" href="/docs/assets/js/34.6fecaaf4.js"><link rel="prefetch" href="/docs/assets/js/35.15ec5007.js"><link rel="prefetch" href="/docs/assets/js/36.111dbe33.js"><link rel="prefetch" href="/docs/assets/js/37.c2b3add1.js"><link rel="prefetch" href="/docs/assets/js/38.828abaf6.js"><link rel="prefetch" href="/docs/assets/js/39.734a24da.js"><link rel="prefetch" href="/docs/assets/js/40.e69160d7.js"><link rel="prefetch" href="/docs/assets/js/41.dd684a74.js"><link rel="prefetch" href="/docs/assets/js/42.309aa73e.js"><link rel="prefetch" href="/docs/assets/js/43.79668988.js"><link rel="prefetch" href="/docs/assets/js/44.167ed7a1.js"><link rel="prefetch" href="/docs/assets/js/45.70f35d40.js"><link rel="prefetch" href="/docs/assets/js/46.c9b62498.js"><link rel="prefetch" href="/docs/assets/js/48.ef9f36c4.js"><link rel="prefetch" href="/docs/assets/js/49.f36e6af6.js"><link rel="prefetch" href="/docs/assets/js/50.ce7d469f.js"><link rel="prefetch" href="/docs/assets/js/51.1bc4f677.js"><link rel="prefetch" href="/docs/assets/js/52.3ad516c7.js"><link rel="prefetch" href="/docs/assets/js/53.74e97523.js"><link rel="prefetch" href="/docs/assets/js/54.0fb41450.js"><link rel="prefetch" href="/docs/assets/js/55.2bafb766.js"><link rel="prefetch" href="/docs/assets/js/56.f7fc87ce.js"><link rel="prefetch" href="/docs/assets/js/57.e58e92d4.js"><link rel="prefetch" href="/docs/assets/js/58.e1315a5a.js"><link rel="prefetch" href="/docs/assets/js/59.2db26cda.js"><link rel="prefetch" href="/docs/assets/js/60.7d1dd448.js"><link rel="prefetch" href="/docs/assets/js/61.23f37ee9.js"><link rel="prefetch" href="/docs/assets/js/62.147ba493.js"><link rel="prefetch" href="/docs/assets/js/63.e7d1038b.js"><link rel="prefetch" href="/docs/assets/js/64.19b6fa3d.js"><link rel="prefetch" href="/docs/assets/js/65.46aa7ef7.js"><link rel="prefetch" href="/docs/assets/js/66.04d3893a.js"><link rel="prefetch" href="/docs/assets/js/67.178c9fba.js"><link rel="prefetch" href="/docs/assets/js/69.c2893f3a.js"><link rel="prefetch" href="/docs/assets/js/70.7a2a176e.js"><link rel="prefetch" href="/docs/assets/js/71.ba13bf2a.js"><link rel="prefetch" href="/docs/assets/js/72.9a0ab200.js"><link rel="prefetch" href="/docs/assets/js/73.932aa523.js"><link rel="prefetch" href="/docs/assets/js/74.8e601453.js"><link rel="prefetch" href="/docs/assets/js/75.50d34247.js"><link rel="prefetch" href="/docs/assets/js/76.42fcca85.js"><link rel="prefetch" href="/docs/assets/js/77.209afa80.js"><link rel="prefetch" href="/docs/assets/js/78.e6a098a4.js"><link rel="prefetch" href="/docs/assets/js/79.df755869.js"><link rel="prefetch" href="/docs/assets/js/80.8485996a.js"><link rel="prefetch" href="/docs/assets/js/81.e1346e6c.js"><link rel="prefetch" href="/docs/assets/js/82.b6a82fab.js"><link rel="prefetch" href="/docs/assets/js/83.3a0aad16.js"><link rel="prefetch" href="/docs/assets/js/84.db8784c0.js"><link rel="prefetch" href="/docs/assets/js/85.b577b1a5.js"><link rel="prefetch" href="/docs/assets/js/86.dc089bcc.js"><link rel="prefetch" href="/docs/assets/js/87.18718c47.js"><link rel="prefetch" href="/docs/assets/js/88.45a535b3.js"><link rel="prefetch" href="/docs/assets/js/89.f4403f46.js"><link rel="prefetch" href="/docs/assets/js/90.88b43a93.js"><link rel="prefetch" href="/docs/assets/js/91.8da65492.js"><link rel="prefetch" href="/docs/assets/js/92.4feea20b.js"><link rel="prefetch" href="/docs/assets/js/93.d45ed88a.js"><link rel="prefetch" href="/docs/assets/js/94.9d832728.js"><link rel="prefetch" href="/docs/assets/js/95.b3dfb83f.js"><link rel="prefetch" href="/docs/assets/js/96.656fee38.js"><link rel="prefetch" href="/docs/assets/js/97.6eff8f66.js"><link rel="prefetch" href="/docs/assets/js/98.9f0e66bc.js"><link rel="prefetch" href="/docs/assets/js/99.032bfecd.js"><link rel="prefetch" href="/docs/assets/js/100.737761ad.js"><link rel="prefetch" href="/docs/assets/js/101.6970e95d.js"><link rel="prefetch" href="/docs/assets/js/102.74d9d087.js"><link rel="prefetch" href="/docs/assets/js/103.b7e392a0.js"><link rel="prefetch" href="/docs/assets/js/104.41a49370.js"><link rel="prefetch" href="/docs/assets/js/105.1019523a.js"><link rel="prefetch" href="/docs/assets/js/106.73b7319e.js"><link rel="prefetch" href="/docs/assets/js/107.9f2f6271.js"><link rel="prefetch" href="/docs/assets/js/108.77620658.js"><link rel="prefetch" href="/docs/assets/js/109.a2956b0d.js"><link rel="prefetch" href="/docs/assets/js/110.23a3ce76.js"><link rel="prefetch" href="/docs/assets/js/111.4ccc0dde.js"><link rel="prefetch" href="/docs/assets/js/112.30932a5c.js"><link rel="prefetch" href="/docs/assets/js/113.14372203.js"><link rel="prefetch" href="/docs/assets/js/114.752dee54.js"><link rel="prefetch" href="/docs/assets/js/115.b6e134e2.js"><link rel="prefetch" href="/docs/assets/js/116.5f0b7e73.js"><link rel="prefetch" href="/docs/assets/js/117.2e438b40.js"><link rel="prefetch" href="/docs/assets/js/118.7bc71357.js"><link rel="prefetch" href="/docs/assets/js/119.7a632ac0.js"><link rel="prefetch" href="/docs/assets/js/120.4fa561c7.js"><link rel="prefetch" href="/docs/assets/js/121.6fea8d64.js"><link rel="prefetch" href="/docs/assets/js/122.1dcd7eb4.js"><link rel="prefetch" href="/docs/assets/js/123.748e1cfa.js"><link rel="prefetch" href="/docs/assets/js/124.fb88d2ce.js"><link rel="prefetch" href="/docs/assets/js/125.30c58dc4.js"><link rel="prefetch" href="/docs/assets/js/126.4928e376.js"><link rel="prefetch" href="/docs/assets/js/127.e4004279.js"><link rel="prefetch" href="/docs/assets/js/128.58004c99.js"><link rel="prefetch" href="/docs/assets/js/129.25166f4c.js"><link rel="prefetch" href="/docs/assets/js/130.ab0b2d61.js"><link rel="prefetch" href="/docs/assets/js/131.cf363208.js"><link rel="prefetch" href="/docs/assets/js/132.b3ccf5bc.js"><link rel="prefetch" href="/docs/assets/js/133.193edc8a.js"><link rel="prefetch" href="/docs/assets/js/134.a208587f.js"><link rel="prefetch" href="/docs/assets/js/135.fd1e63d4.js"><link rel="prefetch" href="/docs/assets/js/136.86a1f4c5.js"><link rel="prefetch" href="/docs/assets/js/137.4291ce53.js"><link rel="prefetch" href="/docs/assets/js/138.28634585.js"><link rel="prefetch" href="/docs/assets/js/139.fc7f3ea7.js"><link rel="prefetch" href="/docs/assets/js/140.c0ed5f14.js"><link rel="prefetch" href="/docs/assets/js/141.679ce97c.js"><link rel="prefetch" href="/docs/assets/js/142.78e11f14.js"><link rel="prefetch" href="/docs/assets/js/143.7162ae6a.js"><link rel="prefetch" href="/docs/assets/js/144.872d5b44.js"><link rel="prefetch" href="/docs/assets/js/145.d4440db9.js"><link rel="prefetch" href="/docs/assets/js/146.11b5e61f.js"><link rel="prefetch" href="/docs/assets/js/147.5904dff6.js"><link rel="prefetch" href="/docs/assets/js/148.40256055.js"><link rel="prefetch" href="/docs/assets/js/149.96a4a846.js"><link rel="prefetch" href="/docs/assets/js/150.95d5f63c.js"><link rel="prefetch" href="/docs/assets/js/151.f623d9c2.js"><link rel="prefetch" href="/docs/assets/js/152.bdda962f.js"><link rel="prefetch" href="/docs/assets/js/153.6277a739.js"><link rel="prefetch" href="/docs/assets/js/154.4fa949c9.js"><link rel="prefetch" href="/docs/assets/js/155.a2861ac9.js"><link rel="prefetch" href="/docs/assets/js/156.ba791bf0.js"><link rel="prefetch" href="/docs/assets/js/157.82f5bd05.js"><link rel="prefetch" href="/docs/assets/js/158.d00242c1.js"><link rel="prefetch" href="/docs/assets/js/159.f6b62543.js"><link rel="prefetch" href="/docs/assets/js/160.f7691c52.js"><link rel="prefetch" href="/docs/assets/js/161.5de90b23.js"><link rel="prefetch" href="/docs/assets/js/162.ac6d4c38.js"><link rel="prefetch" href="/docs/assets/js/163.e43bf690.js"><link rel="prefetch" href="/docs/assets/js/164.fd225455.js"><link rel="prefetch" href="/docs/assets/js/165.33faf5d8.js"><link rel="prefetch" href="/docs/assets/js/166.43c39690.js"><link rel="prefetch" href="/docs/assets/js/167.f60f53cf.js"><link rel="prefetch" href="/docs/assets/js/168.0377ea50.js"><link rel="prefetch" href="/docs/assets/js/169.f2bf444d.js"><link rel="prefetch" href="/docs/assets/js/170.637798a1.js"><link rel="prefetch" href="/docs/assets/js/171.4d9edaa7.js"><link rel="prefetch" href="/docs/assets/js/172.20a017d5.js"><link rel="prefetch" href="/docs/assets/js/173.229ef695.js"><link rel="prefetch" href="/docs/assets/js/174.1d341fad.js"><link rel="prefetch" href="/docs/assets/js/175.ff21c2fa.js"><link rel="prefetch" href="/docs/assets/js/176.58bdd20d.js"><link rel="prefetch" href="/docs/assets/js/177.4b6e419c.js"><link rel="prefetch" href="/docs/assets/js/178.c38eacae.js"><link rel="prefetch" href="/docs/assets/js/179.2102ca04.js"><link rel="prefetch" href="/docs/assets/js/180.0acc8e12.js"><link rel="prefetch" href="/docs/assets/js/181.1191a3b6.js"><link rel="prefetch" href="/docs/assets/js/182.854004ca.js"><link rel="prefetch" href="/docs/assets/js/183.0a0e5b66.js"><link rel="prefetch" href="/docs/assets/js/184.8d8015dc.js"><link rel="prefetch" href="/docs/assets/js/185.1bab7135.js"><link rel="prefetch" href="/docs/assets/js/186.028e62aa.js"><link rel="prefetch" href="/docs/assets/js/187.9c630c62.js"><link rel="prefetch" href="/docs/assets/js/188.9e84d370.js"><link rel="prefetch" href="/docs/assets/js/189.a30ad706.js"><link rel="prefetch" href="/docs/assets/js/190.c8eedc5c.js"><link rel="prefetch" href="/docs/assets/js/191.bb2173bd.js"><link rel="prefetch" href="/docs/assets/js/192.2ce27902.js"><link rel="prefetch" href="/docs/assets/js/193.d991abd1.js"><link rel="prefetch" href="/docs/assets/js/194.b4413a9a.js"><link rel="prefetch" href="/docs/assets/js/195.92e73aa3.js"><link rel="prefetch" href="/docs/assets/js/196.adc1244a.js"><link rel="prefetch" href="/docs/assets/js/197.746b2621.js"><link rel="prefetch" href="/docs/assets/js/198.7b75e1dc.js"><link rel="prefetch" href="/docs/assets/js/199.813641d3.js"><link rel="prefetch" href="/docs/assets/js/200.29bcba4f.js"><link rel="prefetch" href="/docs/assets/js/201.10afeca4.js"><link rel="prefetch" href="/docs/assets/js/202.e6442c0a.js"><link rel="prefetch" href="/docs/assets/js/203.78d9f101.js"><link rel="prefetch" href="/docs/assets/js/204.11c2c1a6.js"><link rel="prefetch" href="/docs/assets/js/205.abddd1a3.js"><link rel="prefetch" href="/docs/assets/js/206.956e1f42.js"><link rel="prefetch" href="/docs/assets/js/207.4299c1ed.js"><link rel="prefetch" href="/docs/assets/js/208.4559c4e3.js"><link rel="prefetch" href="/docs/assets/js/209.7831ea49.js"><link rel="prefetch" href="/docs/assets/js/210.6c8328c6.js"><link rel="prefetch" href="/docs/assets/js/211.15e4b810.js"><link rel="prefetch" href="/docs/assets/js/212.462bf149.js"><link rel="prefetch" href="/docs/assets/js/213.78fd74e8.js"><link rel="prefetch" href="/docs/assets/js/214.d1299a62.js"><link rel="prefetch" href="/docs/assets/js/215.bb04e4d4.js"><link rel="prefetch" href="/docs/assets/js/216.98d1168a.js"><link rel="prefetch" href="/docs/assets/js/217.ac94712a.js"><link rel="prefetch" href="/docs/assets/js/218.b1f0aba6.js"><link rel="prefetch" href="/docs/assets/js/219.8ce0675a.js"><link rel="prefetch" href="/docs/assets/js/220.7186b642.js"><link rel="prefetch" href="/docs/assets/js/222.0d7d0baa.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.8912bdf8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/docs/" class="home-link router-link-active"><!----><span class="site-name">
      zy's docs
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/kkb/" class="nav-link router-link-active">高级前端</a></div><div class="nav-item"><a href="/docs/resource/" class="nav-link">前端资源</a></div><div class="nav-item"><a href="/docs/javascript/" class="nav-link">JavaScript深入简出</a></div><div class="nav-item"><a href="/docs/javascript-wd/" class="nav-link">JavaScript教程-网道</a></div><div class="nav-item"><a href="/docs/http/" class="nav-link">HTTP权威指南</a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/kkb/" class="nav-link router-link-active">高级前端</a></div><div class="nav-item"><a href="/docs/resource/" class="nav-link">前端资源</a></div><div class="nav-item"><a href="/docs/javascript/" class="nav-link">JavaScript深入简出</a></div><div class="nav-item"><a href="/docs/javascript-wd/" class="nav-link">JavaScript教程-网道</a></div><div class="nav-item"><a href="/docs/http/" class="nav-link">HTTP权威指南</a></div><!----></nav><ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>第一章 ECMAScript6基础</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第二章 面向对象编程</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第四章 正则表达式</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第五章 ES6高阶函数</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第六章 Git</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第七章 函数式编程</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第八章 Node.js</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第九章 前后端交互</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第十章 客户端存储</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第十一章 webpack</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第十二章 TypeScript</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第十三章 Vue</span><span class="arrow right"></span></p><!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>第十四章 React</span><span class="arrow down"></span></p><ul class="sidebar-group-items"><li><a href="/docs/kkb/14-react/1-react-base.html" class="sidebar-link">第1节 react基础-1</a></li><li><a href="/docs/kkb/14-react/2-component-lifecycle.html" class="active sidebar-link">第2节 组件通信和生命周</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/kkb/14-react/2-component-lifecycle.html#_1、state和setstate" class="sidebar-link">1、state和setState</a></li><li class="sidebar-sub-header"><a href="/docs/kkb/14-react/2-component-lifecycle.html#_2、setstate的浅合并" class="sidebar-link">2、setState的浅合并</a></li><li class="sidebar-sub-header"><a href="/docs/kkb/14-react/2-component-lifecycle.html#_3、setsatte-同步还是异步方法" class="sidebar-link">3、setSatte - 同步还是异步方法</a></li><li class="sidebar-sub-header"><a href="/docs/kkb/14-react/2-component-lifecycle.html#_4、父子组件间的通信" class="sidebar-link">4、父子组件间的通信</a></li><li class="sidebar-sub-header"><a href="/docs/kkb/14-react/2-component-lifecycle.html#_5、跨组件通信-context" class="sidebar-link">5、跨组件通信 - context</a></li><li class="sidebar-sub-header"><a href="/docs/kkb/14-react/2-component-lifecycle.html#_6、受控组件与非受控组件" class="sidebar-link">6、受控组件与非受控组件</a></li><li class="sidebar-sub-header"><a href="/docs/kkb/14-react/2-component-lifecycle.html#_6、组件的生命周期" class="sidebar-link">6、组件的生命周期</a></li></ul></li><li><a href="/docs/kkb/14-react/3-react-base.html" class="sidebar-link">第3节 react基础-2</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>第十八章 移动端专题</span><span class="arrow right"></span></p><!----></div></li></ul></div><div class="page"><div class="content"><h2 id="_1、state和setstate"><a href="#_1、state和setstate" aria-hidden="true" class="header-anchor">#</a> 1、state和setState</h2><h3 id="setstate-updater-callback"><a href="#setstate-updater-callback" aria-hidden="true" class="header-anchor">#</a> setState(updater, [callback])</h3><p><code>setState</code>用于修改数据，更新组件：</p><ul><li><strong>updater</strong> - 更新数据，数据类型可以是函数或者对象</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// updater - 函数</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    isShow<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isShow
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// updater - 对象</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  isShow<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isShow
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ul><li><strong>callback</strong> - 更新成功后的回调 FUNCTION</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  isShow<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>isShow
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'更新成功'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_2、setstate的浅合并"><a href="#_2、setstate的浅合并" aria-hidden="true" class="header-anchor">#</a> 2、setState的浅合并</h2><h3 id="object-assign-的浅合并"><a href="#object-assign-的浅合并" aria-hidden="true" class="header-anchor">#</a> Object.assign()的浅合并</h3><p>用<code>Object.assign()</code>合并对象时，对象中的对象只能覆盖不能合并，也就是源对象会对目标对象中的对象进行覆盖。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>
  people<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'zy'</span><span class="token punctuation">,</span>
    age<span class="token punctuation">:</span> <span class="token number">29</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  height<span class="token punctuation">:</span> <span class="token string">'165cm'</span>，
  weight<span class="token punctuation">:</span> <span class="token string">'50kg'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj2 <span class="token operator">=</span> <span class="token punctuation">{</span>
  people<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'zy-1'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  height<span class="token punctuation">:</span> <span class="token string">'165cm'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>obj1<span class="token punctuation">,</span> obj2<span class="token punctuation">)</span> <span class="token comment">// ?</span>

<span class="token comment">// obj = {</span>
<span class="token comment">//   people: {</span>
<span class="token comment">//     name: 'zy-1',</span>
<span class="token comment">//   },</span>
<span class="token comment">//   height: '165cm',</span>
<span class="token comment">//   weight: '50kg'</span>
<span class="token comment">// }</span>
</code></pre></div><h3 id="setstate的浅合并"><a href="#setstate的浅合并" aria-hidden="true" class="header-anchor">#</a> setState的浅合并</h3><p>使用 <code>setState</code> 修改状态时，只要返回我们需要修改的状态，<code>setState</code>会进行浅合并(浅拷贝)</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Count</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    people<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      name<span class="token punctuation">:</span> <span class="token string">'zy'</span><span class="token punctuation">,</span>
      age<span class="token punctuation">:</span> <span class="token number">29</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    height<span class="token punctuation">:</span> <span class="token string">'165cm'</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 只修改age, setState就会进行浅合并</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      people<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        age<span class="token punctuation">:</span> <span class="token number">20</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>people<span class="token punctuation">)</span> <span class="token comment">// ?</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>要保证state中的对象不被浅合并，可以：</p><div class="language-js extra-class"><pre class="language-js"><code>  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      num<span class="token punctuation">:</span> <span class="token number">5</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>data<span class="token punctuation">,</span>
      count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><ul><li>调用 <code>setState</code> 之后，会触发生命周期，重新渲染组件</li></ul><h2 id="_3、setsatte-同步还是异步方法"><a href="#_3、setsatte-同步还是异步方法" aria-hidden="true" class="header-anchor">#</a> 3、setSatte - 同步还是异步方法</h2><h3 id="批量更新"><a href="#批量更新" aria-hidden="true" class="header-anchor">#</a> 批量更新</h3><p>在同一个操作中，一次或者多次调用 setState ，正常情况下 React 会将这些 setState 中的更新进行合并，只执行一次更新。</p><ul><li>react通常会集齐一批需要更新的组件，然后一次性更新来保证渲染的性能</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  <span class="token comment">// 只触发一次render()</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">2</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    num<span class="token punctuation">:</span> num <span class="token operator">+</span> <span class="token number">5</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    num<span class="token punctuation">:</span> num <span class="token operator">+</span> <span class="token number">5</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>count递增<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
</code></pre></div><h3 id="思考：setsatte-同步还是异步方法？"><a href="#思考：setsatte-同步还是异步方法？" aria-hidden="true" class="header-anchor">#</a> 思考：setSatte 同步还是异步方法？</h3><p>在触发了<strong>批量更新机制</strong>时，setState 是一个异步方法，否则 setState 是一个同步方法</p><p>如何让setState变成同步呢？
在批量setState调用外用一个异步函数封装起来。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    num<span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>count<span class="token punctuation">,</span> num<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'render'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">--</span><span class="token punctuation">{</span>num<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">// setState异步 - 触发了批量更新机制</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          num<span class="token punctuation">:</span> num <span class="token operator">+</span> <span class="token number">5</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'222'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
         <span class="token comment">// 每个异步函数都会触发render</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
          <span class="token comment">// setState同步</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            count<span class="token punctuation">:</span> num <span class="token operator">+</span> <span class="token number">5</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'333'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点击<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">// 同一个操作中，批量的setState操作，只触发一次render()</span>
        <span class="token comment">// 触发了批量更新机制，setState为异步</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">2</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          num<span class="token punctuation">:</span> num <span class="token operator">+</span> <span class="token number">5</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          num<span class="token punctuation">:</span> num <span class="token operator">+</span> <span class="token number">5</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>num<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>count递增<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="_4、父子组件间的通信"><a href="#_4、父子组件间的通信" aria-hidden="true" class="header-anchor">#</a> 4、父子组件间的通信</h2><p>在 React.js 中，数据是从上自下流动（传递）的，也就是一个父组件可以把它的 state / props 通过 props 传递给它的子组件，但是子组件不能修改 props - React.js 是单向数据流，如果子组件需要修改父组件状态（数据），是通过回调函数方式来完成的。</p><h3 id="父级向子级通信-props"><a href="#父级向子级通信-props" aria-hidden="true" class="header-anchor">#</a> 父级向子级通信 - props</h3><p>把数据添加子组件的属性中，然后子组件中从props属性中，获取父级传递过来的数据</p><h3 id="子级向父级通信-回调函数的方式"><a href="#子级向父级通信-回调函数的方式" aria-hidden="true" class="header-anchor">#</a> 子级向父级通信 - 回调函数的方式</h3><p>在父级中定义相关的数据操作方法(或其他回调), 把该方法传递给子级，在子级中调用该方法父级传递消息</p><h3 id="案例：完善好友列表"><a href="#案例：完善好友列表" aria-hidden="true" class="header-anchor">#</a> 案例：完善好友列表</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> datas <span class="token keyword">from</span> <span class="token string">'./data.js'</span>

<span class="token keyword">import</span> <span class="token string">'./css/index.css'</span>

<span class="token keyword">class</span> <span class="token class-name">Menu</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token function-variable function">changeShowName</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
     <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> showName<span class="token punctuation">,</span> handleChange <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
     <span class="token function">handleChange</span><span class="token punctuation">(</span>name<span class="token operator">===</span>showName<span class="token operator">?</span><span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>name<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>data<span class="token punctuation">,</span> name<span class="token punctuation">,</span> showName<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>dl className<span class="token operator">=</span><span class="token punctuation">{</span><span class="token template-string"><span class="token string">`friend-group </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token operator">===</span>showName<span class="token operator">?</span><span class="token string">&quot;expanded&quot;</span><span class="token punctuation">:</span><span class="token string">''</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">`</span></span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>dt onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>changeShowName<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>data<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>dt<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>data<span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span>index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>dd key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>dd<span class="token operator">&gt;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>dl<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    showName<span class="token punctuation">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      showName<span class="token punctuation">:</span> name
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>showName<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;friend-list&quot;</span><span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>datas<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>key <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>Menu data<span class="token operator">=</span><span class="token punctuation">{</span>datas<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">}</span> showName<span class="token operator">=</span><span class="token punctuation">{</span>showName<span class="token punctuation">}</span> handleChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange<span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span> key<span class="token operator">=</span><span class="token punctuation">{</span>key<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="_5、跨组件通信-context"><a href="#_5、跨组件通信-context" aria-hidden="true" class="header-anchor">#</a> 5、跨组件通信 - context</h2><p>React.createContext对象中，包含Provider，Consumer两个组件；</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// context.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>createContext<span class="token punctuation">}</span>  <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>Provider<span class="token punctuation">,</span>Consumer<span class="token punctuation">}</span> <span class="token operator">=</span> context

<span class="token keyword">export</span> <span class="token punctuation">{</span>
  Provider<span class="token punctuation">,</span> Consumer
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> context
</code></pre></div><h3 id="传递数据-provider组件"><a href="#传递数据-provider组件" aria-hidden="true" class="header-anchor">#</a> 传递数据 - Provider组件</h3><ul><li>父组件给子代组件传递信息</li><li>含有一个value属性，挂载需要传递的数据</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
  name<span class="token punctuation">:</span> <span class="token string">'zy'</span><span class="token punctuation">,</span>
  num<span class="token punctuation">:</span> <span class="token number">123</span>
<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>Container<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Container<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
</code></pre></div><h3 id="接收数据"><a href="#接收数据" aria-hidden="true" class="header-anchor">#</a> 接收数据</h3><ul><li>contextType</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 通过 contextType 接收数据</span>
<span class="token keyword">class</span> <span class="token class-name">Name</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> context
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context
    <span class="token keyword">return</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>Consumer</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 通过 Consumer 组件接收数据</span>
<span class="token keyword">class</span> <span class="token class-name">Age</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Consumer<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Consumer<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>注意在使用不熟练时，最好不要在项目中使用 context，context一般给第三方库使用</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> context<span class="token punctuation">,</span> <span class="token punctuation">{</span>Provider<span class="token punctuation">,</span> Consumer<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>

<span class="token comment">// 通过 contextType 接收数据</span>
<span class="token keyword">class</span> <span class="token class-name">Name</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> context
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>name<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context
    <span class="token keyword">return</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 通过 Consumer 组件接收数据</span>
<span class="token keyword">class</span> <span class="token class-name">Age</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Consumer<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span><span class="token punctuation">{</span>age<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Consumer<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 父组件通过 Provider 给后代组件传递数据</span>
<span class="token keyword">class</span> <span class="token class-name">Container</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Name<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Name<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Age<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Age<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span>
          <span class="token punctuation">{</span>
            name<span class="token punctuation">:</span> <span class="token string">'zy'</span><span class="token punctuation">,</span>
            age<span class="token punctuation">:</span> <span class="token number">18</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Container<span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="_6、受控组件与非受控组件"><a href="#_6、受控组件与非受控组件" aria-hidden="true" class="header-anchor">#</a> 6、受控组件与非受控组件</h2><h3 id="受控组件"><a href="#受控组件" aria-hidden="true" class="header-anchor">#</a> 受控组件</h3><p>受控组件类似于 vue 中，v-model:</p><ul><li>在表单控件之外，获取表单的内部状态时，表单的状态会随着组件的状态之改变;</li><li>在使用受控组件时，必须添加 onChange 回调，在回调中监听 表单的状态改变，然后更新组件状态</li></ul><h3 id="非受控组件"><a href="#非受控组件" aria-hidden="true" class="header-anchor">#</a> 非受控组件</h3><p>在设置表单控件的初始值时，如果直接使用 value 或者 checked 的话，react 会认为我们想要实现的是 受控组件，就会提示我们添加 onchange 回调，否则 控件会变成只读的。</p><p>如果不需要同步value或者checked值，使用 <strong>defaultValue</strong> 或 <strong>defaultChecked</strong></p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">AddTodo</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    val<span class="token punctuation">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>val<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span><span class="token comment">/* 非受控组件 表单： 有value属性 没有onChange事件 input变成只读 */</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span><span class="token comment">/* &lt;input type=&quot;text&quot; value={val} /&gt;&lt;button&gt;添加todo&lt;/button&gt; */</span><span class="token punctuation">}</span>
      <span class="token punctuation">{</span><span class="token comment">/* defaultValue: 不需要同步value值*/</span><span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> defaultValue<span class="token operator">=</span><span class="token punctuation">{</span>val<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>添加todo<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Todos</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    checked<span class="token punctuation">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>checked<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
        <span class="token punctuation">{</span><span class="token comment">/* checked: 非受控组件 组件为只读 */</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span><span class="token comment">/* &lt;input type=&quot;checkbox&quot; checked={checked}/&gt; */</span><span class="token punctuation">}</span>
        <span class="token punctuation">{</span><span class="token comment">/* 添加defaultChecked 不需要同步checked值*/</span><span class="token punctuation">}</span>
        <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;checkbox&quot;</span> defaultChecked<span class="token operator">=</span><span class="token punctuation">{</span>checked<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        zzz
        <span class="token operator">&lt;</span>button<span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="案例：-todolist"><a href="#案例：-todolist" aria-hidden="true" class="header-anchor">#</a> 案例： todoList</h3><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component<span class="token punctuation">,</span> PureComponent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span>  <span class="token string">'react-dom'</span>
<span class="token keyword">import</span> context<span class="token punctuation">,</span> <span class="token punctuation">{</span>Provider<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./context'</span>

<span class="token keyword">class</span> <span class="token class-name">AddTodo</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> context
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    title<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
    user<span class="token punctuation">:</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>addTodo<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context
    <span class="token keyword">const</span> <span class="token punctuation">{</span>title<span class="token punctuation">,</span> user<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'add'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> value<span class="token operator">=</span><span class="token punctuation">{</span>title<span class="token punctuation">}</span>  onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span>target<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          title<span class="token punctuation">:</span> target<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> value<span class="token operator">=</span><span class="token punctuation">{</span>user<span class="token punctuation">}</span>  onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">{</span>target<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          user<span class="token punctuation">:</span> target<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">addTodo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          title<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
          user<span class="token punctuation">:</span> <span class="token string">''</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>添加todo<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Todo</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> context
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>removeTodo<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context
    <span class="token keyword">const</span> <span class="token punctuation">{</span>todo<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>props
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>todo<span class="token punctuation">.</span>title<span class="token punctuation">}</span> <span class="token operator">--</span> <span class="token punctuation">{</span>todo<span class="token punctuation">.</span>user<span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">removeTodo</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>删除<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">Todos</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> contextType <span class="token operator">=</span> context
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>todos<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>context
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>todos<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>todos<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>todo<span class="token punctuation">,</span>index<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>Todo key<span class="token operator">=</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span> todo<span class="token operator">=</span><span class="token punctuation">{</span>todo<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    todos<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">addTodo</span> <span class="token operator">=</span> <span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span>todos<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      todos<span class="token punctuation">:</span> <span class="token punctuation">[</span>
        <span class="token operator">...</span>todos<span class="token punctuation">,</span>
        todo
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">removeTodo</span> <span class="token operator">=</span> <span class="token punctuation">(</span>todo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>todos<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      todos<span class="token punctuation">:</span> todos<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>item <span class="token operator">=&gt;</span> item <span class="token operator">!==</span> todo<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>todos<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>
      todos<span class="token punctuation">:</span> todos<span class="token punctuation">,</span>
      addTodo<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>addTodo<span class="token punctuation">,</span>
      removeTodo<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>removeTodo
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>AddTodo<span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Todos <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><h2 id="_6、组件的生命周期"><a href="#_6、组件的生命周期" aria-hidden="true" class="header-anchor">#</a> 6、组件的生命周期</h2><p><strong>生命周期</strong>指某个事物从开始到结束的各个阶段，在 <code>React.js</code> 中指的是组件从创建到销毁的过程，React.js 在这个过程中的不同阶段调用的函数，通过这些函数，我们可以更加精确的对组件进行控制。</p><ul><li>挂载阶段/渲染阶段</li><li>更新阶段</li><li>卸载阶段</li></ul><p><div isZoom="true"><div class="img-slot"><img src="/docs/assets/img/2-9.5e74b3ab.png"></div></div></p><p><strong>render</strong> 函数其实就是组件生命周期<strong>渲染阶段</strong>执行的函数</p><ul><li>生命周期演变</li></ul><p>16.3 之前，16.3, 16.4 及之后</p><h3 id="挂载阶段-mount"><a href="#挂载阶段-mount" aria-hidden="true" class="header-anchor">#</a> 挂载阶段 - mount</h3><p>组件创建--&gt;把组件创建的虚拟DOM，生成真实DOM，添加到我们的DOM树中</p><ul><li><p><strong>constructor(props)</strong></p><ul><li>组件初始化</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Count初始化'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li><li><p><strong>static getDerivedStateFromProps(props)</strong></p><ul><li>将 props 中内容关联到 state 中</li><li>注意 this 问题: 未定义</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefied</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 返回值就是要关联进 state 中的数据</span>
  <span class="token keyword">return</span> props
<span class="token punctuation">}</span>
</code></pre></div></li><li><p><strong>render</strong></p><ul><li>用jsx构建当前组件的虚拟DOM</li></ul></li><li><p><strong>componentDidMount</strong></p><ul><li>组件挂载完成</li><li>处理副作用：比如异步请求, DOM获取</li></ul></li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Count</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Count初始化'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefied</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 返回值就是要关联进 state 中的数据</span>
    <span class="token keyword">return</span> props
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Coun--render'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>递增<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'组件挂载完成，可以请求异步接口获取数据'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    show<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> show <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 触发组件的挂载</span>
        show<span class="token operator">?</span><span class="token operator">&lt;</span>Count show<span class="token operator">=</span><span class="token punctuation">{</span>show<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token string">''</span>
      <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          show<span class="token punctuation">:</span> <span class="token operator">!</span>show
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>显示<span class="token operator">/</span>隐藏<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="更新阶段-update"><a href="#更新阶段-update" aria-hidden="true" class="header-anchor">#</a> 更新阶段 - update</h3><p>从组件开始更新到修改完成真实的DOM节点：</p><ul><li><strong>static getDerivedStateFromProps(props, state)</strong><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefied</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 返回值就是要关联进 state 中的数据</span>
  <span class="token keyword">return</span> props
<span class="token punctuation">}</span>
</code></pre></div></li><li><strong>shouldComponentUpdate(nextProps,nextState)</strong><ul><li>判断是否更新</li><li>return true 组件更新 || false 不再继续执行更新流程</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 判断是否更新 true 组件更新 false 不再继续执行更新 </span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'shouldComponentUpdate-是否需要更新'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>
</code></pre></div></li><li><strong>render()</strong></li><li><strong>getSnapshotBeforeUpdate(prevProps,prevState)</strong><ul><li>获取更新前的<strong>DOM</strong>快照</li><li>该函数执行时<strong>react</strong>已经完成了新老<strong>DOM</strong>对比，即将更新真实</li><li>我们可以获取更新前的DOM，用于和更新后的DOM进行对比。</li><li>该方法必须配合 <strong>componentDidUpdate</strong> 一块使用，该方法的返回值，会变成 componentDidUpdate 的 pervDOM 参数</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span>prevState<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 获取更新前的DOM快照, </span>
  <span class="token comment">// 必须有一个返回值，返回值会变成 componentDidUpdate 的 pervDOM 参数</span>
  <span class="token comment">// 必须和 componentDidUpdate 一块使用</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'getSnapshotBeforeUpdate-获取更新前的DOM快照'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li><li><strong>componentDidUpdate(prevProps,prevState,pervDOM)</strong></li><li>组件更新完成 处理副作用(请求)</li></ul><div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span>prevState<span class="token punctuation">,</span>pervDOM<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token comment">// 组件更新完成 处理副作用 异步请求 dom操作</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'componentDidUpdate-组件更新完成 '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span>prevState<span class="token punctuation">,</span>pervDOM<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">}</span>
</code></pre></div><h3 id="组件在什么情况下会更新："><a href="#组件在什么情况下会更新：" aria-hidden="true" class="header-anchor">#</a> 组件在什么情况下会更新：</h3><ul><li><ol><li>调用<strong>setState</strong> 引起当前组件进行更新</li></ol></li><li><ol start="2"><li>父组件更新，会引起子组件进行更新</li></ol></li><li><ol start="3"><li>调用 <strong>forceUpdate</strong> 方法强制组件进行更新</li></ol></li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Component <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">class</span> <span class="token class-name">Count</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">getDerivedStateFromProps</span><span class="token punctuation">(</span>props<span class="token punctuation">,</span> state<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 返回值就是要关联进 state 中的数据</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'getDerivedStateFromProps'</span><span class="token punctuation">,</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> props
  <span class="token punctuation">}</span>
  <span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 判断是否更新 true 组件更新 false 不再继续执行更新 </span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'shouldComponentUpdate-是否需要更新'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 渲染虚拟DOM到真实DOM上</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Coun--render'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;count&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>递增<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
  <span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span>prevState<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 获取更新前的DOM快照, </span>
    <span class="token comment">// 必须有一个返回值，返回值会变成 componentDidUpdate 的 pervDOM 参数</span>
    <span class="token comment">// 必须和 componentDidUpdate 一块使用</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'getSnapshotBeforeUpdate-获取更新前的DOM快照'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;#count&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>innerHTML<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidUpdate</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span>prevState<span class="token punctuation">,</span>pervDOM<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 组件更新完成 处理副作用 异步请求 dom操作</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'componentDidUpdate-组件更新完成 '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>prevProps<span class="token punctuation">,</span>prevState<span class="token punctuation">,</span>pervDOM<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    show<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> show <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token punctuation">{</span>
        <span class="token comment">// 触发组件的挂载</span>
        show<span class="token operator">?</span><span class="token operator">&lt;</span>Count show<span class="token operator">=</span><span class="token punctuation">{</span>show<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token string">''</span>
      <span class="token punctuation">}</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          show<span class="token punctuation">:</span> <span class="token operator">!</span>show
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>显示<span class="token operator">/</span>隐藏<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>
  document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><h3 id="卸载阶段-unmount"><a href="#卸载阶段-unmount" aria-hidden="true" class="header-anchor">#</a> 卸载阶段 - unmount</h3><p>从组件准备卸载，到将组件从真实DOM中删除</p><ul><li><strong>componentWillUnmount</strong><ul><li>组件即将卸载</li></ul></li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">Count</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
  state <span class="token operator">=</span> <span class="token punctuation">{</span>
    count<span class="token punctuation">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> count <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Coun--render'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span><span class="token punctuation">{</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>p id<span class="token operator">=</span><span class="token string">&quot;size&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>window<span class="token punctuation">.</span>innerWidth<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          count<span class="token punctuation">:</span> count <span class="token operator">+</span> <span class="token number">1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>递增<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function-variable function">onresize</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> size <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#size'</span><span class="token punctuation">)</span>
      size<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> window<span class="token punctuation">.</span>innerWidth
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>onresize <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'componentWillUnmount- 即将卸载组件'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div><div class="page-edit"><!----><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/docs/kkb/14-react/1-react-base.html" class="prev">
          第1节 react基础-1
        </a></span><span class="next"><a href="/docs/kkb/14-react/3-react-base.html">
          第3节 react基础-2
        </a> →
      </span></p></div></div></div></div>
    <script src="/docs/assets/js/47.8555fc5c.js" defer></script><script src="/docs/assets/js/221.2383e08f.js" defer></script><script src="/docs/assets/js/app.acf4c017.js" defer></script>
  </body>
</html>
